!function(r,t,e){t.wp=t.wp||{},t.wp.sweeppress=t.wp.sweeppress||{},t.wp.sweeppress.helpers={sizeFormat:e=>{var s;return 0===e?"0 B":(s=Math.floor(Math.log(e)/Math.log(1024)),"<strong>"+(e/Math.pow(1024,s)).toFixed(0)+"</strong> "+" KMGTP".charAt(s)+"B")}},t.wp.sweeppress.admin={init:()=>{var e=d4plib_admin_data.page.panel;""!==e&&wp.sweeppress.admin.shared.controls(),"dashboard"===e&&(wp.sweeppress.admin.shared.init(),wp.sweeppress.admin.dashboard.dialogs(),wp.sweeppress.admin.dashboard.init()),"options"===e&&(wp.sweeppress.admin.options.dialogs(),wp.sweeppress.admin.options.init(),wp.sweeppress.admin.shared.options()),"sweep"===e&&(wp.sweeppress.admin.shared.init(),wp.sweeppress.admin.sweep.init())},dashboard:{init:()=>{0<r(".sweeppress-sweeper-check").length&&r(".sweeppress-dashboard-check-all").show(),r(e).on("change",".sweeppress-dashboard-check-all",e=>{var s=r(e.currentTarget).closest(".sweeper-dashboard-overview"),e=r(e.currentTarget).is(":checked");r(".sweeppress-sweeper-check",s).prop("checked",e).change()}),r(e).on("change",".sweeppress-task-check, .sweeppress-sweeper-check",()=>{var e=r(".sweeppress-task-check:checked"),s=e.length;let t=0,a=0;0<s&&e.each((e,s)=>{t+=r(s).data("records"),a+=r(s).data("size")}),r(".sweeppress-sweeper-counters strong").html(t),r(".sweeppress-sweeper-counters span").html(wp.sweeppress.helpers.sizeFormat(a)),r(".sweeppress-sweeper-wrapper input[type=submit]").prop("disabled",0===s)}),r(e).on("click","#sweeppress-information-auto .button-secondary",e=>{e.preventDefault(),r(".sweeper-dashboard-auto").hide(),r(".sweeper-dashboard-overview").show()}),r(e).on("click","#sweeppress-information-auto .button-primary",e=>{e.preventDefault(),r("#sweeppress-dialog-dashboard-auto").wpdialog("open")}),r("form#sweeppress-form-quick").on("submit",e=>{e.preventDefault(),"working"!==r(e.currentTarget).data("status")&&(r(e.currentTarget).slideUp("slow").data("status","working"),r(".sweeppress-dashboard-check-all").hide(),r("#sweeppress-results-quick").slideDown("slow"),r(t).scrollTop(0),r(e.currentTarget).ajaxSubmit({dataType:"html",type:"post",timeout:3e5,url:ajaxurl+"?action=sweeppress-run-quick",success:e=>{r("#sweeppress-results-quick").html(e)},error:(e,s,t)=>{r("#sweeppress-results-quick").html(t)}}))})},auto:()=>{var e=r("#sweeppress-information-auto .button-primary").data("nonce");r("#sweeppress-information-auto").remove(),r("#sweeppress-results-auto").slideDown("slow"),r(t).scrollTop(0),r.ajax({dataType:"html",type:"post",timeout:3e5,url:ajaxurl+"?action=sweeppress-run-auto&_wpnonce="+e,success:e=>{r("#sweeppress-results-auto").html(e)},error:(e,s,t)=>{r("#sweeppress-results-auto").html(t)}})},dialogs:()=>{var e=r.extend({},wp.dev4press.dialogs.default_dialog(),{dialogClass:wp.dev4press.dialogs.classes("sweeppress-dialog-hide-x"),buttons:[{id:"sweeppress-dialog-auto-run",class:"sweeppress-dialog-auto-button-run",text:d4plib_admin_dialogs.buttons.start,data:{icon:"ok"},click:()=>{r("#sweeppress-dialog-dashboard-auto").wpdialog("close"),wp.sweeppress.admin.dashboard.auto()}},{id:"sweeppress-dialog-auto-cancel",class:"sweeppress-dialog-auto-button-cancel button-has-focus",text:d4plib_admin_dialogs.buttons.cancel,data:{icon:"cancel"},autofocus:!0,click:()=>{r("#sweeppress-dialog-dashboard-auto").wpdialog("close")}}]});r("#sweeppress-dialog-dashboard-auto").wpdialog(e),wp.dev4press.dialogs.icons("#sweeppress-dialog-dashboard-auto")}},options:{init:()=>{r(e).on("click",".sweeppress-action-option-delete",e=>{e.preventDefault();var s=r("#sweeppress-dialog-option-key-delete");s.find("h4 strong").html(r(e.currentTarget).data("option")),wp.sweeppress.admin.storage.url=r(e.currentTarget).data("url"),s.wpdialog("open")})},dialogs:()=>{var e=r.extend({},wp.dev4press.dialogs.default_dialog(),{dialogClass:wp.dev4press.dialogs.classes("sweeppress-dialog-hide-x"),buttons:[{id:"sweeppress-dialog-option-key-delete-delete",class:"sweeppress-dialog-option-key-delete-button-delete",text:d4plib_admin_dialogs.buttons.delete,data:{icon:"delete"},click:()=>{t.location.href=wp.sweeppress.admin.storage.url}},{id:"sweeppress-dialog-option-key-delete-cancel",class:"sweeppress-dialog-table-button-cancel button-has-focus",text:d4plib_admin_dialogs.buttons.cancel,data:{icon:"cancel"},autofocus:!0,click:()=>{r("#sweeppress-dialog-option-key-delete").wpdialog("close")}}]}),s=r.extend({},wp.dev4press.dialogs.default_dialog(),{dialogClass:wp.dev4press.dialogs.classes("sweeppress-dialog-hide-x"),buttons:[{id:"sweeppress-dialog-option-bulk-delete-delete",class:"sweeppress-dialog-option-bulk-delete-button-delete",text:d4plib_admin_dialogs.buttons.delete,data:{icon:"delete"},click:()=>{r(".d4p-content form").submit()}},{id:"sweeppress-dialog-option-bulk-delete-cancel",class:"sweeppress-dialog-option-bulk-delete-button-cancel button-has-focus",text:d4plib_admin_dialogs.buttons.cancel,data:{icon:"cancel"},autofocus:!0,click:()=>{r("#sweeppress-dialog-option-bulk-delete").wpdialog("close")}}]});r("#sweeppress-dialog-option-key-delete").wpdialog(e),r("#sweeppress-dialog-option-bulk-delete").wpdialog(s),wp.dev4press.dialogs.icons("#sweeppress-dialog-option-key-delete"),wp.dev4press.dialogs.icons("#sweeppress-dialog-option-bulk-delete")}},sweep:{init:()=>{r(e).on("click",".sweeper-item-refresh",e=>{e.preventDefault();var s=r(e.currentTarget),e=r(e.currentTarget).closest(".sweeppress-item-inside"),t=e.find(".sweeppress-item-run-loader");e.find("div:not(.sweeppress-item-run-loader)").hide(),t.show(),wp.sweeppress.admin.sweep.reload(s,e)}),r(e).on("click",".sweeppress-item-run button",e=>{e.preventDefault();var s=r(e.currentTarget),e=r(e.currentTarget).parent().parent(),t=e.next(),a=e.parent();e.remove(),t.show(),wp.sweeppress.admin.sweep.reload(s,a)}),r(e).on("click","button.toggle-empty-tasks",e=>{e.preventDefault();var s="true"===r(e.currentTarget).attr("aria-expanded"),t=r(e.currentTarget).closest(".sweeppress-sweepers-wrapper");t.find(".empty-sweeper").toggleClass("show-empty-sweeper"),t.find(".empty-sweeper-category").toggleClass("show-empty-sweeper-category"),s?r(e.currentTarget).attr("aria-expanded","false"):r(e.currentTarget).attr("aria-expanded","true")}),r(e).on("click",".sweeppress-item-wrapper h5 button.toggle-empty",e=>{e.preventDefault();var s="true"===r(e.currentTarget).attr("aria-expanded");r(e.currentTarget).closest(".sweeppress-item-wrapper").toggleClass("show-empty-tasks"),s?r(e.currentTarget).attr("aria-expanded","false"):r(e.currentTarget).attr("aria-expanded","true")}),r(e).on("click",".sweeppress-item-wrapper h5 button.toggle-section",e=>{e.preventDefault();var s="#"+r(e.currentTarget).attr("aria-controls");"true"===r(e.currentTarget).attr("aria-expanded")?(r(e.currentTarget).attr("aria-expanded","false"),r(s).prop("hidden",!0)):(r(e.currentTarget).attr("aria-expanded","true"),r(s).prop("hidden",!1))}),r(e).on("change",".sweeppress-task-check, .sweeppress-sweeper-check",()=>{var e=r(".sweeppress-task-check:checked"),s=e.length;let t=0,a=0;0<s&&e.each((e,s)=>{t+=r(s).data("records"),a+=r(s).data("size")}),r(".sweeppress-sweeper-counters .sweeppress-sweep-tasks").html(s),r(".sweeppress-sweeper-counters .sweeppress-sweep-records").html(t),r(".sweeppress-sweeper-counters .sweeppress-sweep-size").html(wp.sweeppress.helpers.sizeFormat(a)),r("#sweeppress-sweep-run").prop("disabled",0===s)}),r("form#sweeppress-form-sweep").on("submit",e=>{if(e.preventDefault(),"working"!==r(e.currentTarget).data("status")){r(e.currentTarget).data("status","working"),r("#sweeppress-results-wrapper").slideDown("slow"),r(".sweeppress-sweepers-wrapper").slideUp("slow",function(){r(this).remove(),r("#sweeppress-sweep-run").remove()}),r(t).scrollTop(0);const a=r("#sweeppress-results-sweeper");r(e.currentTarget).ajaxSubmit({dataType:"html",type:"post",timeout:3e5,url:ajaxurl+"?action=sweeppress-run-sweep",success:e=>{a.html(e)},error:(e,s,t)=>{a.html(t)}})}})},reload:(e,a)=>{r.ajax({dataType:"html",type:"post",timeout:3e5,url:ajaxurl+"?action=sweeppress-manual-estimate",data:{sweeper:e.data("sweeper"),cache:e.data("cache"),_wpnonce:e.data("nonce")},success:e=>{a.html(e),0<r("input",a).length&&a.parent().find("h5 input").show()},error:(e,s,t)=>{a.html(t)}})}},shared:{init:()=>{r(e).on("change",".sweeppress-sweeper-check",e=>{var s=r(e.currentTarget).closest(".sweeppress-item-wrapper"),e=r(e.currentTarget).is(":checked");r(".sweeppress-task-check",s).prop("checked",e).change()})},options:()=>{r(e).on("click",".d4p-content #doaction, .d4p-content #doaction2",e=>{var s=r("#bulk-action-selector-top").val(),t=d4plib_admin_data.page,a=t.subpanel;"delete"===s&&(e.preventDefault(),"options"===t.panel||"sitemeta"===t.panel?r("#sweeppress-dialog-option-bulk-delete").wpdialog("open"):"backups"===t.panel?r("#sweeppress-dialog-backups-bulk-delete").wpdialog("open"):"preview"===a.substring(0,7)?r("#sweeppress-dialog-preview-bulk-delete").wpdialog("open"):"metadata"===a.substring(0,8)&&r("#sweeppress-dialog-metadata-bulk-delete").wpdialog("open"))})},controls:()=>{r(e).on("click",".sweeppress-confirm-url",e=>{e.preventDefault(),confirm(sweeppress_data.are_you_sure)&&(t.location.href=r(e.currentTarget).data("url"))})}},storage:{url:"",table:""}},r(e).ready(()=>{wp.sweeppress.admin.init()})}(jQuery,window,document);